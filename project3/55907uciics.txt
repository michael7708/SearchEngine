
ftindexercombinelists 
id
ftindexercombinelists
5788
2010
10
22
10
09
57z
abehm
copyright
2010
regents
university
california
redistribution
file
permitted
terms
academic
bsd
license
date
04
04
2008
author
shengyue
ji
alexander
behm
ifndef
ftindexerunionglobal
define
ftindexerunionglobal
include
ftindexermemabs
include
gramlistunion
include
statsutil
include
common
src
simmetric
include
listmerger
src
divideskipmerger
include
include
include
uncompressed
indexer
uses
gramlistunion
inverted
list
structure
create
new
uncompressed
indexer
maximize
code
reuse
template
class
ftindexeruncompressedunion
template
struct
ftindexertraits
typedef
tstringcontainer
stringcontainer
typedef
tinvlist
invlist
template
class
ftindexeruncompressedunion
public
ftindexermemabs
private
typedef
ftindexermemabs
superclass
public
typedef
typename
superclass
grammap
grammap
ftindexeruncompressedunion
stringcontainer
strcontainer
gramgen
gramgenerator
unsigned
maxstrlen
150
unsigned
ftfanout
50
superclass
strcontainer
gramgenerator
maxstrlen
ftfanout
ifdef
debug
stat
ixstats
new
indexstats
endif
void
prepare
impl
void
addstringid
impl
filtertreenode
leaf
const
vector
gramcodes
unsigned
stringid
compressionargs
getcompressionargs
impl
return
compressionargs
warning
will
implemented
indexer
saved
loaded
used
within
union
indexers
therefore
saving
loading
neccessary
void
saveindex
impl
const
char
indexfilename
cout
warning
implemented
endl
void
loadindex
impl
const
char
indexfilename
cout
warning
implemented
endl
template
void
ftindexeruncompressedunion
addstringid
impl
filtertreenode
leaf
const
vector
gramcodes
unsigned
stringid
typename
ftindexermemabs
grammap
grammap
leaf
grammap
unsigned
0
gramcodes
size
unsigned
gramcode
gramcodes
grammap
find
gramcode
grammap
end
new
gram
gramlistunion
newgramlist
new
gramlistunion
grammap
gramcode
newgramlist
invlist
array
newgramlist
getarray
array
push
back
stringid
else
existing
gram
gramlist
gramlist
grammap
gramcode
invlist
array
gramlist
getarray
avoid
adding
duplicate
elements
array
back
stringid
array
push
back
stringid
class
candipair
public
unsigned
ida
unsigned
idb
candipair
ida
0
idb
0
candipair
unsigned
unsigned
class
ftindexercombinelistsabs
template
struct
ftindexertraits
typedef
ftindexertraits
traitstype
typedef
typename
traitstype
stringcontainer
stringcontainer
typedef
typename
traitstype
invlist
invlist
template
class
ftindexercombinelistsabs
public
ftindexermemabs
public
typedef
ftindexertraits
traitstype
typedef
typename
traitstype
stringcontainer
stringcontainer
typedef
typename
traitstype
invlist
invlist
ifdef
debug
stat
typedef
unionglobalindexstats
ixstatstype
endif
private
typedef
ftindexermemabs
superclass
protected
typedef
typename
superclass
grammap
grammap
typedef
typename
tr1
unordered
set
candiset
typedef
typename
tr1
unordered
map
sigmap
vector
sampledictionary
ftindexeruncompressedunion
source
vector
target
float
samplingfrac
bool
truerand
false
void
getrandomsample
stringcontainer
source
vector
target
float
samplingfrac
bool
truerand
false
void
copygrammapskeleton
grammap
source
grammap
destination
saving
loading
index
void
saveleaveswithsharedlistsrec
filtertreenode
node
ofstream
fpout
void
loadleaveswithsharedlistsrec
filtertreenode
node
ifstream
fpin
public
ftindexercombinelistsabs
stringcontainer
strcontainer
superclass
strcontainer
globalindex
null
rnds
null
ifdef
debug
stat
ixstats
new
unionglobalindexstats
endif
ftindexercombinelistsabs
stringcontainer
strcontainer
gramgen
gramgenerator
float
reductionratio
float
dictsamplingfrac
unsigned
maxstrlen
150
unsigned
ftfanout
50
unsigned
sigcount
100
unsigned
bandsize
2
superclass
strcontainer
gramgenerator
maxstrlen
ftfanout
reductionratio
reductionratio
dictsamplingfrac
dictsamplingfrac
globalindex
null
originalindexsize
0
rnds
null
sigcount
sigcount
bandsize
bandsize
ifdef
debug
stat
ixstats
new
unionglobalindexstats
dynamic
cast
ixstats
reductionratio
reductionratio
endif
statically
delegate
prepare
implementation
appropriate
subclass
void
prepare
impl
static
cast
chooseunionlists
void
addstringid
impl
filtertreenode
leaf
const
vector
gramcodes
unsigned
stringid
compressionargs
getcompressionargs
impl
return
null
void
saveindex
impl
const
char
indexfilename
void
loadindex
impl
const
char
indexfilename
ftindexercombinelistsabs
globalindex
delete
globalindex
rnds
delete
rnds
template
void
ftindexercombinelistsabs
addstringid
impl
filtertreenode
leaf
const
vector
gramcodes
unsigned
stringid
typename
superclass
grammap
grammap
leaf
grammap
unsigned
0
gramcodes
size
unsigned
gramcode
gramcodes
grammap
find
gramcode
grammap
end
check
gram
shares
list
another
gram
grammapskeleton
find
gramcode
grammapskeleton
end
copy
structure
combined
lists
grammapskeleton
grammap
leaf
copygrammapskeleton
grammapskeleton
grammap
get
list
append
element
gramlist
gramlist
grammap
gramcode
invlist
array
gramlist
getarray
array
push
back
stringid
else
new
gram
share
list
gram
gramlistsimple
newgramlist
new
gramlistsimple
grammap
gramcode
newgramlist
invlist
array
newgramlist
getarray
array
push
back
stringid
else
append
stringid
list
existing
gram
gramlist
gramlist
grammap
gramcode
invlist
array
gramlist
getarray
avoid
adding
duplicate
elements
array
size
0
array
back
stringid
array
push
back
stringid
else
array
push
back
stringid
template
void
ftindexercombinelistsabs
getrandomsample
const
vector
source
vector
target
float
samplingfrac
bool
truerand
truerand
srand
time
null
else
srand
250
samplingfrac
1
0
unsigned
numberstrings
unsigned
float
source
size
samplingfrac
unsigned
0
numberstrings
unsigned
index
rand
source
size
target
push
back
source
index
else
unsigned
0
source
size
target
push
back
source
template
void
ftindexercombinelistsabs
getrandomsample
stringcontainer
source
vector
target
float
samplingfrac
bool
truerand
truerand
srand
time
null
else
srand
250
samplingfrac
1
0
unsigned
numberstrings
unsigned
float
source
size
samplingfrac
unsigned
0
numberstrings
unsigned
index
rand
source
size
string
currentstring
source
retrievestring
currentstring
index
target
push
back
currentstring
else
unsigned
0
source
size
string
currentstring
source
retrievestring
currentstring
target
push
back
currentstring
template
void
ftindexercombinelistsabs
copygrammapskeleton
grammap
source
grammap
destination
typename
grammap
iterator
source
begin
source
end
gramlistunion
gl
dynamic
cast
second
gl
rank
0
source
begin
source
end
gramlistunion
gl
dynamic
cast
second
gl
refcount
1
gl
rank
0
gl
rank
first
gramlistunion
tmpgl
new
gramlistunion
tmpgl
rank
first
destination
first
tmpgl
else
gramlistunion
tmpgl
dynamic
cast
destination
gl
rank
destination
first
tmpgl
tmpgl
refcount
template
float
ftindexercombinelistsabs
lshgreedyth
float
ratio
float
ths
0
9
0
8
0
7
0
6
0
6
0
4
0
3
0
25
0
2
0
18
0
16
0
14
0
12
0
1
0
09
0
08
0
07
0
06
0
05
find
number
candidate
required
satisfy
memory
constraint
unsigned
stringcontainervector
tmpdictcontainer
new
stringcontainervector
tmpdictcontainer
fillcontainer
sampledictionary
begin
sampledictionary
end
0
18
ftindexeruncompresseduniongramgen
index
buildindex
grammap
grammap
index
filtertreeroot
grammap
candiset
cps
adjcandis
grammap
ths
cps
lshcandis
grammap
ths
cps
unsigned
newindexsize
unionlists
grammap
ths
cps
0
0
newindexsize
originalindexsize
break
delete
tmpdictcontainer
return
ths
template
void
ftindexercombinelistsabs
adjcandis
grammap
grammap
float
unionth
candiset
cps
unsigned
minlistsize
candiset
ncps
unsigned
0
sampledictionary
size
vector
gids
gramgen
decompose
sampledictionary
gids
0
gids
size
1
candipair
cp
gids
gids
1
cp
ida
cp
idb
continue
cps
count
cp
ncps
count
cp
continue
grammap
cp
ida
getarray
size
minlistsize
grammap
cp
idb
getarray
size
minlistsize
ncps
insert
cp
continue
gramlistunion
testunion
dynamic
cast
grammap
cp
ida
dynamic
cast
grammap
cp
idb
unionth
true
cps
insert
cp
else
ncps
insert
cp
template
void
ftindexercombinelistsabs
lshcandis
grammap
grammap
float
unionth
candiset
cps
unsigned
minlistsize
unsigned
seed
unsigned
srand
seed
rnds
unsigned
realloc
rnds
sigcount
4
sizeof
unsigned
0
sigcount
4
rnds
rand
gensigs
grammap
minlistsize
candiset
ncps
0
sigcount
bandsize
sigmap
lsh
sigmap
const
iterator
cit
cit
sigs
begin
cit
sigs
end
cit
cit
second
size
bandsize
continue
unsigned
sum
0
0
bandsize
sum
sum
3
sum
sum
cit
second
0
lsh
sum
size
candipair
cp
lsh
sum
cit
first
cps
count
cp
ncps
count
cp
continue
gramlistunion
testunion
dynamic
cast
grammap
cp
ida
dynamic
cast
grammap
cp
idb
unionth
true
cps
insert
cp
else
ncps
insert
cp
lsh
sum
push
back
cit
first
template
unsigned
ftindexercombinelistsabs
unionlists
grammap
grammap
float
unionth
candiset
cps
float
ratio
unsigned
listsunioned
0
unsigned
localsize
originalindexsize
candiset
const
iterator
cit
cit
cps
begin
cit
cps
end
cit
unsigned
saved
gramlistunion
testunion
dynamic
cast
grammap
cit
ida
dynamic
cast
grammap
cit
idb
unionth
saved
listsunioned
localsize
saved
localsize
originalindexsize
break
typename
grammap
iterator
grammap
begin
grammap
end
gramlistunion
gl
dynamic
cast
second
gl
find
grammap
begin
grammap
end
gramlistunion
gl
dynamic
cast
second
grammap
first
gl
clean
return
localsize
template
void
ftindexercombinelistsabs
gensigs
const
grammap
grammap
unsigned
minlistsize
unsigned
typename
grammap
const
iterator
cit
cit
grammap
begin
cit
grammap
end
cit
const
gramlistunion
gl
dynamic
cast
cit
second
gl
list
size
minlistsize
continue
unsigned
count
sigcount
gl
list
size
count
count
gl
list
size
vector
sig
sigs
cit
first
sig
resize
count
0
count
sig
inthash
gl
list
0
1
gl
list
size
0
count
unsigned
newsig
inthash
gl
list
newsig
sig
sig
newsig
template
unsigned
ftindexercombinelistsabs
inthash
unsigned
key
unsigned
hid
const
unsigned
rnd
rnd
rnds
hid
2
key
key
rnd
key
rnd
31
rnd
rnds
hid
2
1
key
key
rnd
key
rnd
31
rnd
rnds
hid
2
2
key
key
rnd
key
rnd
31
rnd
rnds
hid
2
3
key
key
rnd
key
rnd
31
return
key
template
void
ftindexercombinelistsabs
saveleaveswithsharedlistsrec
filtertreenode
node
ofstream
fpout
unsigned
node
isleaf
node
distinctstringids
invlist
distinctarr
node
distinctstringids
getarray
write
distinct
string
ids
distinctarr
size
fpout
write
const
char
sizeof
unsigned
unsigned
0
distinctarr
size
distinctarr
fpout
write
const
char
sizeof
unsigned
else
0
fpout
write
const
char
sizeof
unsigned
unordered
map
listaddrmap
maps
list
address
first
gram
code
points
list
write
gram
map
grammap
grammap
node
grammap
grammap
size
fpout
write
const
char
sizeof
unsigned
typename
grammap
iterator
iter
grammap
begin
iter
grammap
end
iter
iter
first
fpout
write
const
char
sizeof
unsigned
vector
arr
iter
second
getarray
arr
uintptr
listaddr
uintptr
arr
listaddrmap
find
listaddr
listaddrmap
end
insert
address
map
listaddrmap
listaddr
iter
first
unsigned
isfirst
1
fpout
write
const
char
isfirst
sizeof
unsigned
first
gram
referencing
list
write
list
contents
arr
size
fpout
write
const
char
sizeof
unsigned
unsigned
0
arr
size
arr
fpout
write
const
char
sizeof
unsigned
else
previous
gram
referencing
list
stored
content
unsigned
isfirst
0
fpout
write
const
char
isfirst
sizeof
unsigned
first
gram
referencing
list
unsigned
firstgramcode
listaddrmap
listaddr
fpout
write
const
char
firstgramcode
sizeof
unsigned
write
gramcode
points
list
else
2
fpout
write
const
char
sizeof
unsigned
whether
first
list
else
vector
children
node
children
unsigned
0
children
size
saveleaveswithsharedlistsrec
children
node
fpout
template
void
ftindexercombinelistsabs
loadleaveswithsharedlistsrec
filtertreenode
node
ifstream
fpin
node
isleaf
load
distinct
strings
node
distinctstringids
delete
node
distinctstringids
node
distinctstringids
new
gramlistsimple
unsigned
distinctstrings
fpin
read
char
distinctstrings
sizeof
unsigned
distinctstrings
0
node
distinctstringids
new
gramlistsimple
unsigned
0
distinctstrings
unsigned
tmp
fpin
read
char
tmp
sizeof
unsigned
node
distinctstringids
getarray
push
back
tmp
load
gram
map
grammap
grammap
node
grammap
unsigned
grammapsize
unsigned
gramcode
unsigned
arrsize
unsigned
isfirst
unsigned
firstgramcode
fpin
read
char
grammapsize
sizeof
unsigned
unsigned
0
grammapsize
fpin
read
char
gramcode
sizeof
unsigned
fpin
read
char
isfirst
sizeof
unsigned
switch
isfirst
case
0
fpin
read
char
firstgramcode
sizeof
unsigned
gramlistunion
gramlist
dynamic
cast
grammap
firstgramcode
gramlist
refcount
grammap
gramcode
gramlist
break
case
1
fpin
read
char
arrsize
sizeof
unsigned
arrsize
0
gramlistunion
gramlist
new
gramlistunion
gramlist
refcount
1
grammap
gramcode
gramlist
invlist
newarr
gramlist
getarray
unsigned
0
arrsize
unsigned
tmp
fpin
read
char
tmp
sizeof
unsigned
newarr
push
back
tmp
break
case
2
continue
break
default
cout
happen
endl
break
else
vector
children
node
children
unsigned
0
children
size
loadleaveswithsharedlistsrec
children
node
fpin
template
void
ftindexercombinelistsabs
saveindex
impl
const
char
indexfilename
ofstream
fpout
fpout
open
indexfilename
ios
fpout
open
savebasicinfo
fpout
saveleaveswithsharedlistsrec
filtertreeroot
fpout
fpout
close
else
cout
error
open
file
indexfilename
endl
template
void
ftindexercombinelistsabs
loadindex
impl
const
char
indexfilename
ifstream
fpin
fpin
open
indexfilename
ios
fpin
open
filtertypes
clear
loadbasicinfo
fpin
buildhollowtreerecursive
filtertreeroot
0
loadleaveswithsharedlistsrec
filtertreeroot
fpin
fpin
close
else
cout
error
open
file
indexfilename
endl
template
class
ftindexercombinelistsbasic
template
struct
ftindexertraits
typedef
tstringcontainer
stringcontainer
typedef
tinvlist
invlist
template
class
ftindexercombinelistsbasic
public
ftindexercombinelistsabs
private
typedef
ftindexercombinelistsabs
superclass
typedef
typename
superclass
grammap
grammap
public
ftindexercombinelistsbasic
stringcontainer
strcontainer
superclass
strcontainer
ftindexercombinelistsbasic
stringcontainer
strcontainer
gramgen
gramgenerator
float
reductionratio
float
dictsamplingfrac
0
1f
unsigned
maxstrlen
150
unsigned
ftfanout
50
superclass
strcontainer
gramgenerator
reductionratio
dictsamplingfrac
maxstrlen
ftfanout
string
getname
return
ftindexercombinelistsbasic
void
chooseunionlists
template
void
ftindexercombinelistsbasic
chooseunionlists
reductionratio
sampledictionary
clear
getrandomsample
strcontainer
sampledictionary
dictsamplingfrac
build
index
sampling
dictionary
stringcontainervector
tmpdictcontainer
new
stringcontainervector
tmpdictcontainer
fillcontainer
sampledictionary
begin
sampledictionary
end
globalindex
new
ftindexeruncompresseduniongramgen
globalindex
buildindex
delete
tmpdictcontainer
determine
orginal
index
size
originalindexsize
filtertreenode
getsubtreeinvertedlistssize
globalindex
filtertreeroot
float
unionth
lshgreedyth
1
0f
reductionratio
todo
something
method
unsigned
method
3
grammap
grammap
globalindex
filtertreeroot
grammap
typename
superclass
candiset
cps
method
1
adjcandis
grammap
unionth
cps
method
2
lshcandis
grammap
unionth
cps
unionlists
grammap
unionth
cps
1
0f
reductionratio
now
copy
structure
union
skeleton
iun
class
copygrammapskeleton
globalindex
filtertreeroot
grammap
grammapskeleton
cleanup
delete
globalindex
globalindex
null
free
rnds
rnds
null
struct
querysample
unsigned
id
int
th
float
querytime
unsigned
candicount
vector
scancounts
template
class
ftindexercombinelistscost
template
struct
ftindexertraits
typedef
tstringcontainer
stringcontainer
typedef
tinvlist
invlist
template
class
ftindexercombinelistscost
public
ftindexercombinelistsabs
private
typedef
ftindexercombinelistsabs
superclass
typedef
typename
superclass
grammap
grammap
typedef
typename
superclass
candiset
candiset
ftindexeruncompressedunion
merger
const
vector
workload
vector
sampleworkload
float
queriessamplingfrac
const
simmetric
simmetric
float
simthreshold
float
avgpostprocesstime
float
totalquerytime
unsigned
currentindexsize
vector
qs
void
buildpostprocessestimationmodel
const
vector
sampledictionary
const
vector
sampleworkload
const
unsigned
iterations
100
inline
float
getapproxpostprocesstime
const
unsigned
totalcandidates
return
avgpostprocesstime
float
totalcandidates
void
buildmergeestimationmodel
const
vector
sampleworkload
void
initestimations
void
greedyunion
grammap
grammap
float
unionth
float
ratio
unsigned
candiset
cps
void
greedyiteration
grammap
grammap
float
unionth
unsigned
candiset
cps
bool
unionestimation
grammap
grammap
float
unionth
unsigned
gida
unsigned
gidb
unsigned
reduction
float
time
bool
update
false
public
ftindexercombinelistscost
stringcontainer
strcontainer
superclass
strcontainer
queryindex
null
workload
null
simmetric
null
simthreshold
0
0f
queriessamplingfrac
0
0f
avgpostprocesstime
0
0f
totalquerytime
0
0f
currentindexsize
0
ftindexercombinelistscost
stringcontainer
strcontainer
gramgen
gramgenerator
const
float
reductionratio
const
vector
workload
const
simmetric
simmetric
const
float
simthreshold
const
float
dictsamplingfrac
0
1f
const
float
queriessamplingfrac
0
25f
const
unsigned
maxstrlen
150
const
unsigned
ftfanout
50
superclass
strcontainer
gramgenerator
reductionratio
dictsamplingfrac
maxstrlen
ftfanout
queryindex
null
workload
workload
simmetric
simmetric
simthreshold
simthreshold
queriessamplingfrac
queriessamplingfrac
avgpostprocesstime
0
0f
totalquerytime
0
0f
currentindexsize
0
string
getname
return
ftindexercombinelistscost
void
chooseunionlists
ftindexercombinelistscost
queryindex
delete
queryindex
template
void
ftindexercombinelistscost
buildmergeestimationmodel
const
vector
sampleworkload
vector
alllists
vector
allthresholds
filtertreenodeglobalindex
filtertreeroot
gather
lists
queries
unsigned
0
sampleworkload
size
const
string
query
sampleworkload
vector
invertedlists
new
vector
vector
gids
gramgen
decompose
query
gids
leaf
getinvertedlists
gids
invertedlists
alllists
push
back
invertedlists
allthresholds
push
back
simmetric
getmergethreshold
query
gids
simthreshold
null
build
model
merger
fillestimationparams
alllists
allthresholds
cleanup
unsigned
0
alllists
size
vector
invertedlists
alllists
delete
invertedlists
template
void
ftindexercombinelistscost
buildpostprocessestimationmodel
const
vector
sampledictionary
const
vector
sampleworkload
const
unsigned
iterations
statsutil
sutil
srand
150
float
totaltime
0
0
unsigned
counter
0
unsigned
0
iterations
unsigned
rand
sampleworkload
size
string
querystring
sampleworkload
sutil
starttimemeasurement
simmetric
querystring
querystring
sutil
stoptimemeasurement
totaltime
sutil
gettimemeasurement
tfmsec
counter
unsigned
0
sampledictionary
size
sutil
starttimemeasurement
simmetric
querystring
sampledictionary
sutil
stoptimemeasurement
totaltime
sutil
gettimemeasurement
tfmsec
counter
avgpostprocesstime
totaltime
float
counter
template
void
ftindexercombinelistscost
initestimations
buildpostprocessestimationmodel
sampledictionary
sampleworkload
buildmergeestimationmodel
sampleworkload
qs
resize
sampleworkload
size
unsigned
init
estimation
totalquerytime
0
0
float
totalpptime
0
0
0
sampleworkload
size
querysample
qs
th
int
simmetric
getmergethreshold
sampleworkload
simthreshold
null
candicount
0
querytime
0
0f
scancounts
resize
sampledictionary
size
0
scancounts
size
scancounts
0
th
sampledictionary
size
querytime
getapproxpostprocesstime
candicount
totalquerytime
querytime
continue
init
scan
count
vector
filtertreenodeglobalindex
filtertreeroot
vector
invertedlists
leaf
getinvertedlists
sampleworkload
gramgen
invertedlists
0
invertedlists
size
vector
invertedlists
0
size
scancounts
count
candidates
0
scancounts
size
scancounts
unsigned
th
candicount
initialize
query
time
float
mergetime
merger
getestimatedquerytime
invertedlists
th
float
currentpptime
getapproxpostprocesstime
candicount
querytime
mergetime
currentpptime
totalpptime
currentpptime
add
total
query
time
candi
count
totalquerytime
querytime
template
void
ftindexercombinelistscost
greedyunion
grammap
grammap
float
unionth
float
ratio
unsigned
candiset
cps
currentindexsize
originalindexsize
currentindexsize
unsigned
ratio
originalindexsize
cps
size
cout
iteration
currentindexsize
unsigned
ratio
originalindexsize
endl
greedyiteration
grammap
unionth
cps
compress
paths
typename
grammap
iterator
grammap
begin
grammap
end
gramlistunion
gl
dynamic
cast
second
gl
find
grammap
begin
grammap
end
gramlistunion
gl
dynamic
cast
second
grammap
first
gl
clean
template
void
ftindexercombinelistscost
greedyiteration
grammap
grammap
float
unionth
unsigned
candiset
cps
greedy
search
best
score
unsigned
reduction
0
float
time
totalquerytime
multimap
topk
multimap
iterator
loop
candidates
typename
candiset
iterator
csit
csit
cps
begin
csit
cps
end
csit
unionestimation
grammap
unionth
csit
ida
csit
idb
reduction
time
int
score
int
1000000
time
reduction
topk
begin
topk
size
score
first
topk
insert
pair
score
csit
topk
size
topk
begin
topk
erase
else
score
2
first
cps
erase
csit
topk
size
0
cps
clear
return
union
top
grammap
queriesmap
queryindex
filtertreeroot
grammap
topk
begin
topk
end
unionestimation
grammap
unionth
second
ida
second
idb
reduction
time
true
currentindexsize
gramlistunion
testunion
dynamic
cast
grammap
second
ida
dynamic
cast
grammap
second
idb
listsunioned
queriesmap
count
second
ida
queriesmap
count
second
idb
gramlistunion
testunion
dynamic
cast
queriesmap
second
ida
dynamic
cast
queriesmap
second
idb
cps
erase
second
template
bool
ftindexercombinelistscost
unionestimation
grammap
grammap
float
unionth
unsigned
gida
unsigned
gidb
unsigned
reduction
float
time
bool
update
vector
exta
extb
reduction
0
time
totalquerytime
gramlistunion
gla
dynamic
cast
grammap
gida
gramlistunion
glb
dynamic
cast
grammap
gidb
gla
glb
return
false
vector
gla
find
list
vector
glb
find
list
gida
gidb
might
missing
query
list
use
dummy
instead
grammap
queriesmap
queryindex
filtertreeroot
grammap
vector
dummy
vector
qa
dummy
qb
dummy
queriesmap
count
gida
gramlistunion
qla
dynamic
cast
queriesmap
gida
qa
qla
find
list
queriesmap
count
gidb
gramlistunion
qlb
dynamic
cast
queriesmap
gidb
qb
qlb
find
list
compute
exta
extb
unsigned
0
0
0
size
size
exta
push
back
else
extb
push
back
else
increase
reduction
reduction
size
exta
push
back
size
extb
push
back
reduction
unsigned
unionth
exta
size
size
return
false
affected
query
0
0
qa
size
qb
size
retrieve
query
move
cursor
forward
set
ea
eb
int
ea
0
eb
0
qa
size
qa
qb
size
qb
gids
vector
gsize
gramgen
decompose
sampleworkload
gids
gramlistunion
tmpgla
dynamic
cast
grammap
gida
gramlistunion
tmpglb
dynamic
cast
grammap
gidb
find
counta
countb
initialize
gram
size
list
unsigned
counta
0
countb
0
0
gids
size
grammap
count
gids
gramlistunion
tmpglk
dynamic
cast
grammap
gids
unsigned
size
tmpglk
find
list
size
ea
tmpglk
find
tmpgla
find
size
exta
size
counta
else
eb
tmpglk
find
tmpglb
find
size
extb
size
countb
size
gsize
push
back
size
count
candidate
delta
unsigned
delta
0
counta
0
exta
size
unsigned
original
0
original
scancounts
exta
original
unsigned
th
original
counta
unsigned
th
delta
update
scancounts
exta
original
counta
countb
0
extb
size
unsigned
original
0
original
scancounts
extb
original
unsigned
th
original
countb
unsigned
th
delta
update
scancounts
extb
original
countb
filtertreenodeglobalindex
filtertreeroot
vector
invertedlists
leaf
getinvertedlists
gids
invertedlists
update
candicount
delta
totalquerytime
querytime
todo
check
shengyue
delta
see
querytime
merger
getestimatedquerytime
invertedlists
th
getapproxpostprocesstime
candicount
assert
querytime
querytime
totalquerytime
querytime
time
totalquerytime
continue
recompute
time
time
querytime
time
merger
getestimatedquerytime
invertedlists
th
assert
time
time
time
getapproxpostprocesstime
candicount
delta
todo
see
delta
return
true
template
void
ftindexercombinelistscost
chooseunionlists
reductionratio
sampledictionary
clear
getrandomsample
strcontainer
sampledictionary
dictsamplingfrac
sampleworkload
clear
getrandomsample
workload
sampleworkload
queriessamplingfrac
build
index
sampling
dictionary
stringcontainervector
tmpdictcontainer
new
stringcontainervector
tmpdictcontainer
fillcontainer
sampledictionary
begin
sampledictionary
end
globalindex
new
ftindexeruncompresseduniongramgen
globalindex
buildindex
delete
tmpdictcontainer
build
index
queries
stringcontainervector
tmpqueriescontainer
new
stringcontainervector
tmpqueriescontainer
fillcontainer
sampleworkload
begin
sampleworkload
end
queryindex
new
ftindexeruncompresseduniongramgen
queryindex
buildindex
delete
tmpqueriescontainer
determine
orginal
index
size
originalindexsize
filtertreenode
getsubtreeinvertedlistssize
globalindex
filtertreeroot
float
unionth
lshgreedyth
1
0f
reductionratio
todo
something
method
unsigned
method
3
grammap
grammap
globalindex
filtertreeroot
grammap
typename
superclass
candiset
cps
method
1
adjcandis
grammap
unionth
cps
method
2
lshcandis
grammap
unionth
cps
initestimations
unsigned
cps
size
100
cps
size
100
1
greedyunion
grammap
unionth
1
0f
reductionratio
cps
now
copy
structure
union
skeleton
iun
class
copygrammapskeleton
globalindex
filtertreeroot
grammap
grammapskeleton
cleanup
delete
globalindex
globalindex
null
free
rnds
rnds
null
endif
