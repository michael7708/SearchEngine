
divideskipmerger 
id
divideskipmerger
4887
2009
12
16
22
01
55z
abehm
copyright
2010
regents
university
california
redistribution
file
permitted
terms
bsd
license
imeplementation
merges
multiple
lists
dividedskip
algorithm
lists
assumed
sorted
ascending
order
author
jiaheng
lu
alexander
behm
date
05
23
2007
ifndef
divideskipmerger
define
divideskipmerger
include
include
include
include
include
include
include
include
include
include
include
include
include
include
include
listmerger
include
utilities
include
util
misc
include
heap
divideskip
algorithm
combine
mergeopt
mergeskip
algorithm
template
class
divideskipmerger
public
listsmerger
invlist
private
estimation
purposes
float
shortlistsslope
float
shortlistsintercept
float
longlistsslope
float
longlistsintercept
calculating
float
mu
exponential
probe
returns
iterator
first
element
greater
equal
value
inline
typename
invlist
iterator
expprobe
typename
invlist
iterator
start
typename
invlist
iterator
end
unsigned
value
const
mergeskip
weights
given
void
mergeskip
const
vector
arrays
const
vector
weights
const
unsigned
threshold
const
unsigned
longlists
vector
results
vector
counters
detect
lists
identical
references
return
vector
distinct
lists
weights
void
detectduplicatelists
vector
arrays
vector
newarrays
vector
newweights
consider
list
weights
void
mergewithduplicatelists
vector
arrays
const
unsigned
threshold
vector
results
helper
query
time
estimatiom
void
getquerystats
const
vector
arrays
const
unsigned
threshold
float
shortlistsvar
float
shortliststime
float
longlistsvar
float
longliststime
public
divideskipmerger
bool
hasduplicatelists
false
hasduplicatelists
hasduplicatelists
shortlistsslope
0
0f
shortlistsintercept
0
0f
longlistsslope
0
0f
longlistsintercept
0
0f
mu
0
01
void
merge
impl
vector
arrays
const
unsigned
threshold
vector
results
void
fillestimationparams
const
vector
arrays
const
vector
thresholds
float
getestimatedquerytime
const
vector
arrays
const
unsigned
threshold
const
static
bool
cmpinvlist
const
invlist
const
invlist
return
size
size
mergeskip
every
list
equal
weight
void
mergeskip
const
vector
arrays
const
unsigned
threshold
const
unsigned
longlists
vector
results
vector
counters
string
getname
return
divideskipmerger
template
typename
invlist
iterator
divideskipmerger
expprobe
typename
invlist
iterator
start
typename
invlist
iterator
end
unsigned
value
const
unsigned
0
typename
invlist
iterator
iter
start
1
iter
end
return
end
else
iter
value
return
iter
template
void
divideskipmerger
mergeskip
const
vector
arrays
const
unsigned
threshold
const
unsigned
longlists
vector
results
vector
counters
const
unsigned
maxunsigned
0xffffffff
unsigned
numberofinvertedlist
arrays
size
longlists
threshold
numberofinvertedlist
return
unsigned
pointersindex
numberofinvertedlist
memset
pointersindex
0
numberofinvertedlist
sizeof
unsigned
add
max
unsigned
unsigned
0
numberofinvertedlist
arrays
append
maxunsigned
unsigned
dataheap
numberofinvertedlist
unsigned
indexheap
numberofinvertedlist
make
initial
heap
unsigned
size
0
unsigned
0
numberofinvertedlist
unsigned
arrays
0
heapinsert
dataheap
indexheap
size
unsigned
sizeofheaps
numberofinvertedlist
unsigned
pivot
threshold
1
unsigned
vectorindexcontainer
numberofinvertedlist
dataheap
0
maxunsigned
container
vector
indexes
moved
next
position
unsigned
containersize
0
unsigned
mindata
dataheap
0
mindata
dataheap
0
containersize
numberofinvertedlist
vectorindexcontainer
containersize
indexheap
0
heapdelete
dataheap
indexheap
sizeofheaps
containersize
threshold
counters
push
back
containersize
results
push
back
mindata
move
next
element
unsigned
0
containersize
unsigned
vectorindexcontainer
pointersindex
insert
heaps
unsigned
0
containersize
unsigned
index
vectorindexcontainer
unsigned
position
pointersindex
index
unsigned
newdata
arrays
index
position
heapinsert
newdata
index
dataheap
indexheap
sizeofheaps
continue
pop
elements
heap
skip
nodes
containersize
pivot
vectorindexcontainer
containersize
indexheap
0
heapdelete
dataheap
indexheap
sizeofheaps
skip
nodes
unsigned
0
containersize
unsigned
vectorindexcontainer
unsigned
oldposition
pointersindex
pointersindex
arrays
binarysearch
dataheap
0
oldposition
insert
heaps
unsigned
0
containersize
unsigned
index
vectorindexcontainer
unsigned
position
pointersindex
index
unsigned
newdata
arrays
index
position
heapinsert
newdata
index
dataheap
indexheap
sizeofheaps
remove
last
maxunsigned
element
unsigned
0
numberofinvertedlist
arrays
removelastelement
template
void
divideskipmerger
merge
impl
vector
arrays
const
unsigned
threshold
vector
results
unsigned
sizeofinvertedlists
arrays
size
sizeofinvertedlists
threshold
signed
threshold
hasduplicatelists
mergewithduplicatelists
arrays
threshold
results
return
sort
arrays
begin
arrays
end
divideskipmerger
cmpinvlist
unsigned
longestsize
arrays
arrays
size
1
size
unsigned
longlistssize
unsigned
floor
threshold
mu
log2
longestsize
1
longlistssize
threshold
longlistssize
threshold
1
use
mergeskip
search
short
lists
vector
partialresults
counters
mergeskip
arrays
threshold
longlistssize
longlistssize
partialresults
counters
unsigned
stop
arrays
size
unsigned
start
stop
longlistssize
typename
invlist
iterator
longlistspointers
longlistssize
unsigned
start
stop
longlistspointers
start
arrays
begin
use
exponential
probe
binary
search
long
lists
register
unsigned
0
partialresults
size
unsigned
id
partialresults
counters
threshold
unsigned
freq
0
unsigned
start
stop
unsigned
llindex
start
typename
invlist
iterator
start
longlistspointers
llindex
typename
invlist
iterator
end
expprobe
start
arrays
end
id
typename
invlist
iterator
iter
lower
bound
start
end
id
iter
id
freq
longlistspointers
llindex
iter
freq
counters
threshold
results
push
back
id
else
results
push
back
id
template
void
divideskipmerger
getquerystats
const
vector
arrays
const
unsigned
threshold
float
shortlistsvar
float
shortliststime
float
longlistsvar
float
longliststime
struct
timeval
t1
t2
struct
timezone
tz
unsigned
sizeofinvertedlists
arrays
size
sizeofinvertedlists
threshold
return
unsigned
sortedindex
sizeofinvertedlists
sortbysizeoflists
arrays
sortedindex
unsigned
longestsize
arrays
sortedindex
arrays
size
1
size
unsigned
longlistssize
unsigned
floor
threshold
mu
log2
longestsize
1
longlistssize
threshold
longlistssize
threshold
1
vector
longlists
shortlists
splittwosets
longlists
shortlists
threshold
arrays
sortedindex
longlistssize
vector
partialresults
counters
gettimeofday
t1
tz
mergeskipshortlists
shortlists
threshold
longlistssize
partialresults
counters
gettimeofday
t2
tz
shortliststime
t2
tv
sec
t1
tv
sec
1000000
t2
tv
usec
t1
tv
usec
1000
0f
unsigned
longlistspointers
longlists
size
memset
longlistspointers
0
sizeof
unsigned
longlists
size
use
binary
search
hash
search
long
lists
vector
results
gettimeofday
t1
tz
register
unsigned
0
ibinarysearch
id
longlistspointers
longlistspointers
pos
pos
longlists
size
longlists
pos
id
freq
freq
counters
threshold
results
push
back
id
else
results
push
back
id
gettimeofday
t2
tz
longliststime
t2
tv
sec
t1
tv
sec
1000000
t2
tv
usec
t1
tv
usec
1000
0f
calculate
total
sizes
short
lists
float
log2
log
2
unsigned
shortlistssize
0
unsigned
0
isize
calculate
log2
sum
total
size
long
lists
float
loglonglists
0
0f
unsigned
0
isize
log2
shortlistsvar
float
shortlistssize
float
threshold
longlists
size
loglonglists
longlistsvar
shortlistssize
log
sizeofinvertedlists
log2
template
void
divideskipmerger
fillestimationparams
const
vector
arrays
const
vector
thresholds
vector
shortlistsxvals
vector
shortlistsyvals
vector
longlistsxvals
vector
longlistsyvals
float
shortlistsxval
0
0f
float
shortlistsyval
0
0f
float
longlistsxval
0
0f
float
longlistsyval
0
0f
unsigned
0
arrays
size
vector
currentarrs
arrays
currentarrs
size
float
divideskipmerger
getestimatedquerytime
const
vector
arrays
const
unsigned
threshold
const
unsigned
sizeofinvertedlists
arrays
size
sizeofinvertedlists
threshold
return
0
0f
unsigned
sortedindex
sizeofinvertedlists
sortbysizeoflists
arrays
sortedindex
unsigned
longestsize
arrays
sortedindex
arrays
size
1
size
unsigned
longlistssize
unsigned
floor
threshold
mu
log2
longestsize
1
longlistssize
threshold
longlistssize
threshold
1
vector
longlists
shortlists
splittwosets
longlists
shortlists
threshold
arrays
sortedindex
longlistssize
calculate
total
sizes
short
lists
float
log2
log
2
unsigned
shortlistssize
0
unsigned
0
isize
calculate
log2
sum
total
size
long
lists
float
loglonglists
0
0f
unsigned
0
isize
log2
float
shortlistsvar
float
shortlistssize
float
threshold
longlists
size
loglonglists
float
longlistsvar
shortlistssize
log
sizeofinvertedlists
log2
return
shortlistsvar
shortlistsslope
longlistsvar
longlistsslope
shortlistsintercept
longlistsintercept
template
void
divideskipmerger
detectduplicatelists
vector
arrays
vector
newarrays
vector
newweights
need
take
care
unequal
lists
size
exhaustive
search
within
list
length
group
sort
arrays
begin
arrays
end
divideskipmerger
cmpinvlist
set
arraysadded
unsigned
0
arrays
size
array
currentarray
arrays
unsigned
arraddr
unsigned
currentarray
unsigned
currentcount
1
array
added
previously
arraysadded
find
arraddr
arraysadded
end
search
arrays
length
identical
pointers
unsigned
1
arrays
size
array
iarray
arrays
iarray
size
currentarray
size
break
iarray
currentarray
currentcount
add
array
newarrays
push
back
currentarray
newweights
push
back
currentcount
arraysadded
insert
arraddr
alex
debug
unsigned
weightsum
0
unsigned
0
newarrays
size
array
tmp
newarrays
bool
contains
false
unsigned
0
tmp
size
tmp
49
contains
true
break
contains
cout
list
unsigned
newarrays
newweights
endl
weightsum
newweights
cout
weightsum
weightsum
endl
template
void
divideskipmerger
mergeskip
const
vector
arrays
const
vector
weights
const
unsigned
threshold
const
unsigned
longlists
vector
results
vector
counters
const
unsigned
maxunsigned
0xffffffff
unsigned
numberofinvertedlist
arrays
size
longlists
unsigned
pointersindex
numberofinvertedlist
memset
pointersindex
0
numberofinvertedlist
sizeof
unsigned
add
max
unsigned
unsigned
0
numberofinvertedlist
arrays
append
maxunsigned
unsigned
dataheap
numberofinvertedlist
unsigned
indexheap
numberofinvertedlist
make
initial
heap
unsigned
size
0
unsigned
0
numberofinvertedlist
unsigned
arrays
0
heapinsert
dataheap
indexheap
size
unsigned
sizeofheaps
numberofinvertedlist
unsigned
pivot
threshold
1
unsigned
vectorindexcontainer
numberofinvertedlist
dataheap
0
maxunsigned
container
vector
indexes
moved
next
position
unsigned
containerweight
0
containersize
0
check
can
get
result
unsigned
mindata
dataheap
0
mindata
dataheap
0
containersize
numberofinvertedlist
vectorindexcontainer
containersize
indexheap
0
containerweight
weights
indexheap
0
heapdelete
dataheap
indexheap
sizeofheaps
containerweight
threshold
counters
push
back
containerweight
results
push
back
mindata
move
next
element
unsigned
0
iat
position
heapinsert
newdata
index
dataheap
indexheap
sizeofheaps
continue
pop
elements
heap
skip
nodes
containerweight
pivot
fix
alex
possible
list
weight
equals
containerweight
weights
indexheap
0
pivot
break
vectorindexcontainer
containersize
indexheap
0
containerweight
weights
indexheap
0
heapdelete
dataheap
indexheap
sizeofheaps
skip
nodes
unsigned
0
containersize
unsigned
vectorindexcontainer
unsigned
oldposition
pointersindex
pointersindex
arrays
binarysearch
dataheap
0
oldposition
insert
heaps
unsigned
0
containersize
unsigned
index
vectorindexcontainer
unsigned
position
pointersindex
index
unsigned
newdata
arrays
index
position
heapinsert
newdata
index
dataheap
indexheap
sizeofheaps
remove
last
maxunsigned
element
unsigned
0
numberofinvertedlist
arrays
removelastelement
template
void
divideskipmerger
mergewithduplicatelists
vector
arrays
const
unsigned
threshold
vector
results
vector
newarrays
vector
newweights
detectduplicatelists
arrays
newarrays
newweights
assume
newarray
sorted
according
length
increasing
unsigned
longestsize
newarrays
newarrays
size
1
size
unsigned
targetlonglistweight
unsigned
floor
threshold
mu
log2
longestsize
1
targetlonglistweight
threshold
targetlonglistweight
threshold
1
start
bugfix
alex
correct
check
unsigned
longlistssize
0
unsigned
totallonglistweight
0
unsigned
0
newarrays
size
unsigned
currentweight
newweights
newarrays
size
1
totallonglistweight
currentweight
totallonglistweight
targetlonglistweight
totallonglistweight
threshold
longlistssize
totallonglistweight
currentweight
else
longlistssize
1
break
end
bugfix
alex
alex
debug
cout
threshold
threshold
endl
cout
longlistssize
endl
unsigned
llsum
0
unsigned
0
longlists
size
cout
longlist
unsigned
longlists
longlistsweights
longlists
size
endl
llsum
longlistsweights
cout
llsum
llsum
endl
unsigned
slsum
0
unsigned
0
shortlists
size
cout
shortlist
unsigned
shortlists
shortlistsweights
shortlists
size
endl
slsum
shortlistsweights
cout
slsum
slsum
endl
fixed
alex
new
threshold
totallonglistweight
cout
merging
short
lists
endl
cout
totallonglistweight
threshold
totallonglistweight
endl
cout
st
threshold
totallonglistweight
endl
vector
partialresults
counters
mergeskip
newarrays
newweights
threshold
totallonglistweight
longlistssize
partialresults
counters
cout
merging
short
lists
endl
unsigned
stop
newarrays
size
unsigned
start
stop
longlistssize
typename
invlist
iterator
longlistspointers
longlistssize
unsigned
start
stop
longlistspointers
start
newarrays
begin
register
unsigned
0
partialresults
size
unsigned
id
partialresults
counters
threshold
unsigned
freq
0
unsigned
start
stop
unsigned
llindex
start
typename
invlist
iterator
start
longlistspointers
llindex
typename
invlist
iterator
end
expprobe
start
newarrays
end
id
typename
invlist
iterator
iter
lower
bound
start
end
id
iter
id
freq
newweights
longlistspointers
llindex
iter
freq
counters
threshold
results
push
back
id
else
results
push
back
id
endif
